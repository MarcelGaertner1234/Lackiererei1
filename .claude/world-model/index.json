{
  "_meta": {
    "description": "Master-Index des Codebase-Weltmodells",
    "version": "3.0",
    "lastUpdated": "2025-12-12",
    "lastAnalysis": "2025-12-12T00:15:00+01:00"
  },

  "statistics": {
    "totalFiles": 95,
    "totalLines": 165000,
    "totalLearnings": 45,
    "worldModelFiles": 13,
    "analysisDepth": "comprehensive"
  },

  "world_model_files": {
    "core": {
      "file-map.json": "Dateistruktur und Kategorien",
      "dependencies.json": "Abhängigkeits-Graph",
      "hotspots.json": "Bug-Hotspots",
      "patterns-by-file.json": "Pattern-Mapping"
    },
    "functions": {
      "function-index.json": "Funktions-Index",
      "data-schemas.json": "Datenstrukturen"
    },
    "workflows": {
      "workflows.json": "Workflow-Dokumentation",
      "events.json": "Event-Handler"
    },
    "technical": {
      "validation.json": "Validierungs-Patterns",
      "apis.json": "API-Dokumentation",
      "runtime-patterns.json": "Runtime-Patterns",
      "edge-cases.json": "Edge Cases"
    },
    "tools": {
      "query.sh": "Weltmodell-Abfragen",
      "update.sh": "Weltmodell-Update",
      "predict-bugs.py": "Bug-Vorhersage",
      "analyze-learnings.py": "Learning-Analyse",
      "context-generator.sh": "Kontext-Generator",
      "session-tracker.sh": "Session-Tracking",
      "analyze-complexity.sh": "Complexity-Analyse"
    }
  },

  "key_metrics": {
    "code": {
      "async_functions": 571,
      "try_catch_blocks": 991,
      "onclick_handlers": 1344,
      "fallback_patterns": 2180,
      "console_logs": 3129
    },
    "firebase": {
      "getCollection_usage": 154,
      "onSnapshot_listeners": 113,
      "cloud_functions": 36
    },
    "ui": {
      "modals": 191,
      "toast_calls": 174,
      "form_required_fields": 677
    }
  },

  "top_hotspots": [
    { "file": "kanban.html", "risk": "critical", "lines": 11163, "bugs": 15 },
    { "file": "kalkulation.html", "risk": "high", "lines": 21693, "bugs": 6 },
    { "file": "annahme.html", "risk": "high", "lines": 10774, "bugs": 10 },
    { "file": "tagesplanung.html", "risk": "high", "lines": 6069, "bugs": 8 }
  ],

  "critical_patterns": [
    { "pattern": "multi-tenant", "description": "window.getCollection() statt db.collection()" },
    { "pattern": "serviceTyp-readonly", "description": "Nach Erstellung NIEMALS ändern" },
    { "pattern": "firebase-init", "description": "await window.firebaseInitialized" },
    { "pattern": "listener-registry", "description": "Memory Leak Prevention" },
    { "pattern": "collection-sync", "description": "fahrzeuge UND partnerAnfragen aktualisieren" }
  ],

  "usage_guide": {
    "quick_start": [
      "query.sh summary - Übersicht",
      "query.sh hotspot - Bug-Hotspots",
      "query.sh file <name> - Datei-Info"
    ],
    "deep_analysis": [
      "context-generator.sh <file> --full",
      "predict-bugs.py <file>",
      "analyze-learnings.py --recommendations"
    ],
    "session": [
      "session-tracker.sh start",
      "session-tracker.sh log '<action>'",
      "session-tracker.sh end"
    ]
  }
}
