{
  "_meta": {
    "description": "Master-Index des Codebase-Weltmodells",
    "version": "3.5",
    "lastUpdated": "2025-12-23",
    "lastAnalysis": "2025-12-23T21:00:00+01:00"
  },

  "statistics": {
    "totalFiles": 230,
    "totalLines": 274889,
    "htmlFiles": 86,
    "jsFiles": 20,
    "testFiles": 31,
    "totalLearnings": 46,
    "worldModelFiles": 14,
    "analysisDepth": "comprehensive",
    "consoleLogs": 4327
  },

  "world_model_files": {
    "core": {
      "file-map.json": "Dateistruktur und Kategorien",
      "dependencies.json": "Abhängigkeits-Graph",
      "hotspots.json": "Bug-Hotspots",
      "patterns-by-file.json": "Pattern-Mapping"
    },
    "functions": {
      "function-index.json": "Funktions-Index",
      "data-schemas.json": "Datenstrukturen"
    },
    "workflows": {
      "workflows.json": "Workflow-Dokumentation",
      "events.json": "Event-Handler"
    },
    "technical": {
      "validation.json": "Validierungs-Patterns",
      "apis.json": "API-Dokumentation",
      "runtime-patterns.json": "Runtime-Patterns",
      "edge-cases.json": "Edge Cases"
    },
    "tools": {
      "query.sh": "Weltmodell-Abfragen",
      "update.sh": "Weltmodell-Update",
      "predict-bugs.py": "Bug-Vorhersage",
      "analyze-learnings.py": "Learning-Analyse",
      "context-generator.sh": "Kontext-Generator",
      "session-tracker.sh": "Session-Tracking",
      "analyze-complexity.sh": "Complexity-Analyse"
    }
  },

  "key_metrics": {
    "code": {
      "async_functions": 571,
      "try_catch_blocks": 991,
      "onclick_handlers": 1344,
      "fallback_patterns": 2180,
      "console_logs": 4327
    },
    "firebase": {
      "getCollection_usage": 154,
      "onSnapshot_listeners": 113,
      "cloud_functions": 36
    },
    "ui": {
      "modals": 191,
      "toast_calls": 174,
      "form_required_fields": 677
    }
  },

  "top_hotspots": [
    { "file": "kalkulation.html", "risk": "critical", "lines": 21818, "functions": 668, "note": "Largest file, Float precision issues" },
    { "file": "kanban.html", "risk": "critical", "lines": 11375, "bugs": 20, "note": "serviceTyp overwrites = DATA LOSS" },
    { "file": "annahme.html", "risk": "high", "lines": 10808, "functions": 281, "note": "Safari photo upload bug" },
    { "file": "partner-app/meine-anfragen.html", "risk": "critical", "lines": 9874, "commits": 334, "note": "Most modified file!" },
    { "file": "tagesplanung.html", "risk": "high", "lines": 6291, "bugs": 15, "note": "Array bounds, null-checks" },
    { "file": "functions/index.js", "risk": "high", "lines": 6851, "functions": 310, "note": "Cloud Functions (169 Firebase calls)" }
  ],

  "critical_patterns": [
    { "pattern": "multi-tenant", "description": "window.getCollection() statt db.collection()" },
    { "pattern": "serviceTyp-readonly", "description": "Nach Erstellung NIEMALS ändern" },
    { "pattern": "firebase-init", "description": "await window.firebaseInitialized" },
    { "pattern": "listener-registry", "description": "Memory Leak Prevention" },
    { "pattern": "collection-sync", "description": "fahrzeuge UND partnerAnfragen aktualisieren" }
  ],

  "usage_guide": {
    "quick_start": [
      "query.sh summary - Übersicht",
      "query.sh hotspot - Bug-Hotspots",
      "query.sh file <name> - Datei-Info"
    ],
    "deep_analysis": [
      "context-generator.sh <file> --full",
      "predict-bugs.py <file>",
      "analyze-learnings.py --recommendations"
    ],
    "session": [
      "session-tracker.sh start",
      "session-tracker.sh log '<action>'",
      "session-tracker.sh end"
    ]
  }
}
