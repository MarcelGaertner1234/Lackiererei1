{
  "_meta": {
    "description": "Datenstrukturen und Schemas der wichtigsten Collections",
    "version": "1.0",
    "lastUpdated": "2025-12-12"
  },

  "fahrzeuge": {
    "description": "Haupt-Collection f체r Fahrzeuge im Werkstatt-Workflow",
    "topFields": {
      "kennzeichen": { "usage": 94, "type": "string", "required": true },
      "serviceTyp": { "usage": 74, "type": "string", "required": true, "READONLY": true },
      "additionalServices": { "usage": 128, "type": "array", "note": "Zus채tzliche Services" },
      "serviceStatuses": { "usage": 54, "type": "object", "note": "Status pro Service" },
      "kva": { "usage": 74, "type": "object", "note": "Kostenvoranschlag-Daten" },
      "kalkulationData": { "usage": 49, "type": "object", "note": "Kalkulations-Details" },
      "marke": { "usage": 41, "type": "string" },
      "modell": { "usage": 42, "type": "string" },
      "prozessStatus": { "usage": 28, "type": "string", "values": ["anlieferung", "selbstbringer", "abholung"] },
      "servicePlan": { "usage": 14, "type": "array", "note": "Geplante Services" }
    },
    "timestamps": {
      "prozessTimestamps": { "usage": 20, "type": "object", "note": "Prozess-Zeitstempel" },
      "statusHistory": { "usage": 15, "type": "array", "note": "Status-Historie" },
      "geplantesAbnahmeDatum": { "usage": 15, "type": "timestamp" },
      "abholtermin": { "usage": 9, "type": "timestamp" }
    },
    "logistik": {
      "abholserviceGewuenscht": { "usage": 10, "type": "boolean" },
      "logistikDetails": { "usage": 11, "type": "object" }
    },
    "finanzen": {
      "vereinbarterPreis": { "usage": 21, "type": "number" },
      "rechnung": { "usage": 9, "type": "object" },
      "tagesmiete": { "usage": 11, "type": "number" }
    },
    "pdfs": {
      "pdfUrl": { "usage": 11, "type": "string" },
      "entwurfPdfUrl": { "usage": 8, "type": "string" }
    }
  },

  "partnerAnfragen": {
    "description": "Anfragen von externen Partnern",
    "topFields": {
      "kva": { "usage": 353, "type": "object", "note": "Kostenvoranschlag" },
      "serviceData": { "usage": 347, "type": "object", "note": "Service-spezifische Daten" },
      "serviceTyp": { "usage": 144, "type": "string", "required": true },
      "serviceDetails": { "usage": 137, "type": "object" },
      "serviceLabels": { "usage": 98, "type": "array", "note": "Service-Labels f체r UI" },
      "fahrzeug": { "usage": 98, "type": "object", "note": "Fahrzeug-Stammdaten" },
      "kennzeichen": { "usage": 89, "type": "string" },
      "status": { "usage": 74, "type": "string", "values": ["neu", "warte_kva", "kva_gesendet", "beauftragt", "abgelehnt", "storniert"] },
      "auftragsnummer": { "usage": 67, "type": "string" },
      "angebotDetails": { "usage": 57, "type": "object" }
    },
    "partner": {
      "partnerName": { "usage": 40, "type": "string" },
      "partnerId": { "type": "string", "note": "Referenz zum Partner" }
    },
    "logistik": {
      "ersatzfahrzeugGewuenscht": { "usage": 32, "type": "boolean" },
      "abholserviceGewuenscht": { "usage": 30, "type": "boolean" },
      "anliefertermin": { "usage": 47, "type": "timestamp" },
      "abholtermin": { "usage": 30, "type": "timestamp" }
    },
    "import": {
      "pdfImport": { "usage": 31, "type": "object", "note": "DAT-PDF Import Daten" }
    }
  },

  "users": {
    "description": "Firebase Auth Benutzer (GLOBAL - kein Multi-Tenant!)",
    "fields": {
      "email": { "type": "string", "required": true },
      "role": { "type": "string", "values": ["superadmin", "admin", "werkstatt", "mitarbeiter", "partner", "kunde", "steuerberater"] },
      "status": { "type": "string", "values": ["active", "inactive", "pending"] },
      "werkstattId": { "type": "string", "note": "Zuordnung zur Werkstatt" }
    }
  },

  "mitarbeiter": {
    "description": "Mitarbeiter-Stammdaten (Multi-Tenant)",
    "fields": {
      "name": { "type": "string", "required": true },
      "email": { "type": "string" },
      "abteilung": { "type": "string", "values": ["lackier", "karosserie", "mechanik", "logistik", "buero"] },
      "skillLevel": { "type": "string", "values": ["junior", "mittel", "senior", "meister"] },
      "status": { "type": "string", "values": ["active", "inactive"] }
    }
  },

  "arbeitszeiten": {
    "description": "Arbeitszeit-Tracking f체r ML-Training (Multi-Tenant)",
    "fields": {
      "fahrzeugId": { "type": "string", "required": true },
      "mitarbeiterId": { "type": "string", "required": true },
      "arbeitstyp": { "type": "string" },
      "startzeit": { "type": "timestamp" },
      "endzeit": { "type": "timestamp" },
      "dauerMinuten": { "type": "number" },
      "mitarbeiterSkillLevel": { "type": "string" },
      "schwierigkeit": { "type": "number", "range": "1-5" }
    },
    "note": "Neu: AGI Training Data Collection"
  }
}
