<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Teile-Karte - Fahrzeugauswahl</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #1a1a2e;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --accent-color: #3b82f6;
            --accent-hover: #2563eb;
            --selected-color: #ef4444;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);

            /* Category Colors */
            --cat-karosserie: #3b82f6;
            --cat-verglasung: #8b5cf6;
            --cat-beleuchtung: #f59e0b;
            --cat-innenraum: #10b981;
            --cat-mechanik: #6b7280;

            /* Part Fills */
            --part-fill: #e5e7eb;
            --part-stroke: #9ca3af;
            --part-hover: rgba(59, 130, 246, 0.3);
            --glas-fill: rgba(147, 197, 253, 0.5);
            --glas-stroke: #60a5fa;
        }

        [data-theme="dark"] {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-color: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --shadow: 0 4px 12px rgba(0,0,0,0.3);

            --part-fill: #334155;
            --part-stroke: #475569;
            --glas-fill: rgba(96, 165, 250, 0.3);
            --glas-stroke: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 16px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .header h1 {
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .theme-toggle {
            padding: 8px 12px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .theme-toggle:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        /* Main Layout */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 16px;
        }

        @media (max-width: 1000px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* Car View Container */
        .car-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow);
        }

        /* View Tabs */
        .view-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .view-tab {
            padding: 10px 16px;
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-color);
            transition: all 0.2s;
        }

        .view-tab:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .view-tab.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        /* Controls Row */
        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .category-filters {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 6px 12px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            background: transparent;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }

        .category-btn:hover {
            border-color: var(--accent-color);
        }

        .category-btn.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        .category-btn .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .zoom-controls {
            display: flex;
            gap: 4px;
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-color);
            cursor: pointer;
            font-size: 1rem;
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .zoom-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        /* SVG Container */
        .svg-wrapper {
            background: var(--bg-color);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .svg-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            min-height: 400px;
            transform-origin: center center;
            transition: transform 0.3s ease;
        }

        .car-svg {
            max-width: 100%;
            height: auto;
        }

        /* Part Styling */
        .car-part {
            fill: var(--part-fill);
            stroke: var(--part-stroke);
            stroke-width: 2;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .car-part:hover {
            fill: var(--part-hover);
            stroke: var(--accent-color);
            stroke-width: 3;
        }

        .car-part.selected {
            fill: rgba(239, 68, 68, 0.3);
            stroke: var(--selected-color);
            stroke-width: 3;
        }

        .car-part.dimmed {
            opacity: 0.15;
            pointer-events: none;
        }

        /* Glas Parts */
        .part-glas {
            fill: var(--glas-fill);
            stroke: var(--glas-stroke);
        }

        /* Static elements */
        .car-body {
            fill: none;
            stroke: var(--part-stroke);
            stroke-width: 3;
            pointer-events: none;
        }

        .car-shadow {
            fill: rgba(0,0,0,0.1);
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .sidebar-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow);
        }

        .sidebar-card h3 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .parts-count {
            background: var(--accent-color);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            margin-left: auto;
        }

        /* Selected List */
        .selected-list {
            list-style: none;
            max-height: 200px;
            overflow-y: auto;
        }

        .selected-list::-webkit-scrollbar {
            width: 5px;
        }

        .selected-list::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        .selected-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            margin-bottom: 4px;
            background: var(--bg-color);
            border-radius: 6px;
            font-size: 0.8rem;
        }

        .selected-list .category-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .selected-list .part-info {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .selected-list .remove-btn {
            background: none;
            border: none;
            color: var(--selected-color);
            cursor: pointer;
            font-size: 1rem;
            padding: 0 4px;
            opacity: 0.7;
        }

        .selected-list .remove-btn:hover {
            opacity: 1;
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .empty-state .icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
        }

        .btn-danger {
            background: var(--selected-color);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-color);
        }

        .btn-outline:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        /* Legend */
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: var(--card-bg);
            color: var(--text-color);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.15s;
        }

        .tooltip.visible {
            opacity: 1;
        }

        .tooltip-title {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .tooltip-category {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>
                <span>üöó</span>
                2D Teile-Karte
                <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">Professionelle Auswahl</span>
            </h1>
            <div class="header-controls">
                <button class="theme-toggle" onclick="toggleTheme()">
                    <span id="themeIcon">üåô</span>
                    <span id="themeText">Dark</span>
                </button>
            </div>
        </header>

        <div class="main-content">
            <div class="car-container">
                <!-- View Tabs -->
                <div class="view-tabs">
                    <button class="view-tab active" data-view="side" onclick="switchView('side')">
                        üöó Seitenansicht
                    </button>
                    <button class="view-tab" data-view="front" onclick="switchView('front')">
                        üöô Frontansicht
                    </button>
                    <button class="view-tab" data-view="rear" onclick="switchView('rear')">
                        üöò Heckansicht
                    </button>
                    <button class="view-tab" data-view="top" onclick="switchView('top')">
                        ‚¨áÔ∏è Draufsicht
                    </button>
                </div>

                <div class="controls-row">
                    <div class="category-filters">
                        <button class="category-btn active" data-category="all" onclick="filterCategory('all')">
                            Alle
                        </button>
                        <button class="category-btn" data-category="karosserie" onclick="filterCategory('karosserie')">
                            <span class="dot" style="background: var(--cat-karosserie)"></span>
                            Karosserie
                        </button>
                        <button class="category-btn" data-category="verglasung" onclick="filterCategory('verglasung')">
                            <span class="dot" style="background: var(--cat-verglasung)"></span>
                            Verglasung
                        </button>
                        <button class="category-btn" data-category="beleuchtung" onclick="filterCategory('beleuchtung')">
                            <span class="dot" style="background: var(--cat-beleuchtung)"></span>
                            Beleuchtung
                        </button>
                        <button class="category-btn" data-category="innenraum" onclick="filterCategory('innenraum')">
                            <span class="dot" style="background: var(--cat-innenraum)"></span>
                            Innenraum
                        </button>
                        <button class="category-btn" data-category="mechanik" onclick="filterCategory('mechanik')">
                            <span class="dot" style="background: var(--cat-mechanik)"></span>
                            Mechanik
                        </button>
                    </div>
                    <div class="zoom-controls">
                        <button class="zoom-btn" onclick="zoomIn()">+</button>
                        <button class="zoom-btn" onclick="zoomOut()">‚àí</button>
                        <button class="zoom-btn" onclick="resetZoom()">‚ü≤</button>
                    </div>
                </div>

                <div class="svg-wrapper">
                    <div class="svg-container" id="svgContainer">
                        <!-- SEITENANSICHT -->
                        <svg id="view-side" viewBox="0 0 800 320" class="car-svg">
                            <!-- Shadow -->
                            <ellipse class="car-shadow" cx="400" cy="300" rx="320" ry="15"/>

                            <!-- R√§der -->
                            <g class="car-part" data-part="rad-vl" data-category="mechanik">
                                <circle cx="150" cy="260" r="50" fill="#333" stroke="#222" stroke-width="3"/>
                                <circle cx="150" cy="260" r="35" fill="#444"/>
                                <circle cx="150" cy="260" r="15" fill="#666"/>
                            </g>
                            <g class="car-part" data-part="rad-hl" data-category="mechanik">
                                <circle cx="620" cy="260" r="50" fill="#333" stroke="#222" stroke-width="3"/>
                                <circle cx="620" cy="260" r="35" fill="#444"/>
                                <circle cx="620" cy="260" r="15" fill="#666"/>
                            </g>

                            <!-- Schweller -->
                            <rect class="car-part" data-part="schweller-l" data-category="karosserie"
                                x="180" y="220" width="410" height="25" rx="3"/>

                            <!-- Kotfl√ºgel vorne links -->
                            <path class="car-part" data-part="kotfluegel-vl" data-category="karosserie"
                                d="M 80 220 Q 80 170 120 150 L 200 150 L 200 220 Q 150 230 150 260 Q 150 290 200 300 L 200 220 L 180 220 L 180 300 Q 100 290 80 260 Q 70 240 80 220 Z"/>

                            <!-- Kotfl√ºgel hinten links -->
                            <path class="car-part" data-part="kotfluegel-hl" data-category="karosserie"
                                d="M 590 220 L 590 300 Q 580 300 570 280 Q 570 260 590 260 Q 610 260 620 260 Q 670 260 670 280 Q 680 300 720 300 L 720 180 Q 700 170 680 175 L 650 180 L 650 220 L 590 220 Z"/>

                            <!-- T√ºr vorne links -->
                            <rect class="car-part" data-part="tuer-vl" data-category="karosserie"
                                x="200" y="120" width="150" height="105" rx="5"/>

                            <!-- T√ºr hinten links -->
                            <rect class="car-part" data-part="tuer-hl" data-category="karosserie"
                                x="355" y="120" width="150" height="105" rx="5"/>

                            <!-- B-S√§ule -->
                            <rect class="car-part" data-part="b-saeule-l" data-category="karosserie"
                                x="347" y="60" width="16" height="170" rx="2"/>

                            <!-- C-S√§ule -->
                            <path class="car-part" data-part="c-saeule-l" data-category="karosserie"
                                d="M 505 60 L 520 60 Q 560 80 590 130 L 590 180 L 505 180 Z"/>

                            <!-- Motorhaube -->
                            <path class="car-part" data-part="motorhaube" data-category="karosserie"
                                d="M 120 150 L 200 120 L 200 60 Q 140 55 100 80 Q 80 100 80 140 Q 80 150 100 155 Z"/>

                            <!-- A-S√§ule links -->
                            <path class="car-part" data-part="a-saeule-l" data-category="karosserie"
                                d="M 200 60 L 220 55 L 235 55 L 210 120 L 200 120 Z"/>

                            <!-- Dach -->
                            <path class="car-part" data-part="dach" data-category="karosserie"
                                d="M 235 55 L 505 55 L 505 65 L 235 65 Z"/>

                            <!-- Heckklappe -->
                            <path class="car-part" data-part="heckklappe" data-category="karosserie"
                                d="M 590 130 Q 640 100 680 90 L 720 90 L 720 180 L 590 180 Z"/>

                            <!-- Sto√üstange vorne -->
                            <path class="car-part" data-part="stossstange-vorne" data-category="karosserie"
                                d="M 50 160 Q 40 180 40 200 L 40 250 Q 45 270 80 280 L 80 220 Q 70 200 70 180 Q 70 165 80 155 L 120 150 L 100 155 Q 60 155 50 160 Z"/>

                            <!-- Sto√üstange hinten -->
                            <path class="car-part" data-part="stossstange-hinten" data-category="karosserie"
                                d="M 720 90 L 750 100 Q 765 120 770 160 L 770 240 Q 765 270 740 280 L 720 280 L 720 180 L 720 90 Z"/>

                            <!-- VERGLASUNG -->
                            <!-- Windschutzscheibe -->
                            <path class="car-part part-glas" data-part="windschutzscheibe" data-category="verglasung"
                                d="M 200 60 L 235 55 L 235 65 L 235 120 L 200 120 Z"/>

                            <!-- Seitenscheibe vorne links -->
                            <polygon class="car-part part-glas" data-part="scheibe-vl" data-category="verglasung"
                                points="238,65 345,65 345,118 238,118"/>

                            <!-- Seitenscheibe hinten links -->
                            <polygon class="car-part part-glas" data-part="scheibe-hl" data-category="verglasung"
                                points="365,65 502,65 502,118 502,175 365,118"/>

                            <!-- Heckscheibe -->
                            <path class="car-part part-glas" data-part="heckscheibe" data-category="verglasung"
                                d="M 505 60 L 590 130 L 590 175 L 505 175 Z"/>

                            <!-- BELEUCHTUNG -->
                            <!-- Scheinwerfer links -->
                            <ellipse class="car-part" data-part="scheinwerfer-l" data-category="beleuchtung"
                                cx="85" cy="170" rx="25" ry="18" fill="#fffacd" stroke="#ffd700"/>

                            <!-- R√ºckleuchte links -->
                            <rect class="car-part" data-part="rueckleuchte-l" data-category="beleuchtung"
                                x="725" y="120" width="20" height="60" rx="4" fill="#ff6b6b" stroke="#cc0000"/>

                            <!-- Nebelscheinwerfer -->
                            <ellipse class="car-part" data-part="nebelscheinwerfer-l" data-category="beleuchtung"
                                cx="60" cy="230" rx="12" ry="10" fill="#fffacd" stroke="#ffd700"/>

                            <!-- Spiegel -->
                            <rect class="car-part" data-part="seitenspiegel-l" data-category="karosserie"
                                x="192" y="105" width="18" height="25" rx="3"/>

                            <!-- INNENRAUM (sichtbar durch Scheiben) -->
                            <rect class="car-part" data-part="sitz-fahrer" data-category="innenraum"
                                x="250" y="130" width="40" height="50" rx="5" fill="#8b7355" stroke="#5d4e3a"/>
                            <rect class="car-part" data-part="sitz-beifahrer" data-category="innenraum"
                                x="380" y="130" width="40" height="50" rx="5" fill="#8b7355" stroke="#5d4e3a"/>

                            <!-- Lenkrad -->
                            <circle class="car-part" data-part="lenkrad" data-category="innenraum"
                                cx="260" cy="100" r="18" fill="none" stroke="#333" stroke-width="4"/>
                        </svg>

                        <!-- FRONTANSICHT -->
                        <svg id="view-front" viewBox="0 0 400 300" class="car-svg" style="display: none;">
                            <!-- Shadow -->
                            <ellipse class="car-shadow" cx="200" cy="280" rx="150" ry="12"/>

                            <!-- R√§der -->
                            <ellipse class="car-part" data-part="rad-vl" data-category="mechanik"
                                cx="60" cy="240" rx="30" ry="45" fill="#333" stroke="#222"/>
                            <ellipse class="car-part" data-part="rad-vr" data-category="mechanik"
                                cx="340" cy="240" rx="30" ry="45" fill="#333" stroke="#222"/>

                            <!-- Sto√üstange vorne -->
                            <path class="car-part" data-part="stossstange-vorne" data-category="karosserie"
                                d="M 50 200 Q 30 210 30 230 L 30 260 Q 35 275 70 280 L 330 280 Q 365 275 370 260 L 370 230 Q 370 210 350 200 L 50 200 Z"/>

                            <!-- K√ºhlergrill -->
                            <rect class="car-part" data-part="kuehlergrill" data-category="karosserie"
                                x="100" y="180" width="200" height="30" rx="5"/>

                            <!-- Motorhaube -->
                            <path class="car-part" data-part="motorhaube" data-category="karosserie"
                                d="M 60 180 L 60 100 Q 80 60 200 50 Q 320 60 340 100 L 340 180 L 60 180 Z"/>

                            <!-- Kotfl√ºgel vorne links -->
                            <path class="car-part" data-part="kotfluegel-vl" data-category="karosserie"
                                d="M 30 200 L 30 140 Q 40 100 60 100 L 60 200 Z"/>

                            <!-- Kotfl√ºgel vorne rechts -->
                            <path class="car-part" data-part="kotfluegel-vr" data-category="karosserie"
                                d="M 340 200 L 340 100 Q 360 100 370 140 L 370 200 Z"/>

                            <!-- A-S√§ulen -->
                            <rect class="car-part" data-part="a-saeule-l" data-category="karosserie"
                                x="55" y="45" width="20" height="60" rx="3"/>
                            <rect class="car-part" data-part="a-saeule-r" data-category="karosserie"
                                x="325" y="45" width="20" height="60" rx="3"/>

                            <!-- Dach -->
                            <path class="car-part" data-part="dach" data-category="karosserie"
                                d="M 75 45 Q 200 30 325 45 L 325 55 Q 200 40 75 55 Z"/>

                            <!-- Windschutzscheibe -->
                            <path class="car-part part-glas" data-part="windschutzscheibe" data-category="verglasung"
                                d="M 75 50 L 80 100 L 320 100 L 325 50 Q 200 35 75 50 Z"/>

                            <!-- Scheinwerfer -->
                            <ellipse class="car-part" data-part="scheinwerfer-l" data-category="beleuchtung"
                                cx="80" cy="165" rx="35" ry="25" fill="#fffacd" stroke="#ffd700"/>
                            <ellipse class="car-part" data-part="scheinwerfer-r" data-category="beleuchtung"
                                cx="320" cy="165" rx="35" ry="25" fill="#fffacd" stroke="#ffd700"/>

                            <!-- Nebelscheinwerfer -->
                            <ellipse class="car-part" data-part="nebelscheinwerfer-l" data-category="beleuchtung"
                                cx="70" cy="235" rx="15" ry="12" fill="#fffacd" stroke="#ffd700"/>
                            <ellipse class="car-part" data-part="nebelscheinwerfer-r" data-category="beleuchtung"
                                cx="330" cy="235" rx="15" ry="12" fill="#fffacd" stroke="#ffd700"/>

                            <!-- Kennzeichen -->
                            <rect x="140" y="230" width="120" height="25" rx="3" fill="white" stroke="#333"/>

                            <!-- Spiegel -->
                            <rect class="car-part" data-part="seitenspiegel-l" data-category="karosserie"
                                x="20" y="100" width="30" height="20" rx="4"/>
                            <rect class="car-part" data-part="seitenspiegel-r" data-category="karosserie"
                                x="350" y="100" width="30" height="20" rx="4"/>
                        </svg>

                        <!-- HECKANSICHT -->
                        <svg id="view-rear" viewBox="0 0 400 300" class="car-svg" style="display: none;">
                            <!-- Shadow -->
                            <ellipse class="car-shadow" cx="200" cy="280" rx="150" ry="12"/>

                            <!-- R√§der -->
                            <ellipse class="car-part" data-part="rad-hl" data-category="mechanik"
                                cx="60" cy="240" rx="30" ry="45" fill="#333" stroke="#222"/>
                            <ellipse class="car-part" data-part="rad-hr" data-category="mechanik"
                                cx="340" cy="240" rx="30" ry="45" fill="#333" stroke="#222"/>

                            <!-- Sto√üstange hinten -->
                            <path class="car-part" data-part="stossstange-hinten" data-category="karosserie"
                                d="M 50 200 Q 30 210 30 230 L 30 260 Q 35 275 70 280 L 330 280 Q 365 275 370 260 L 370 230 Q 370 210 350 200 L 50 200 Z"/>

                            <!-- Auspuff -->
                            <ellipse class="car-part" data-part="auspuff" data-category="mechanik"
                                cx="120" cy="265" rx="20" ry="10" fill="#555" stroke="#333"/>

                            <!-- Heckklappe -->
                            <path class="car-part" data-part="heckklappe" data-category="karosserie"
                                d="M 50 200 L 50 80 Q 60 50 200 40 Q 340 50 350 80 L 350 200 L 50 200 Z"/>

                            <!-- Kotfl√ºgel hinten -->
                            <path class="car-part" data-part="kotfluegel-hl" data-category="karosserie"
                                d="M 30 200 L 30 120 Q 35 100 50 100 L 50 200 Z"/>
                            <path class="car-part" data-part="kotfluegel-hr" data-category="karosserie"
                                d="M 350 200 L 350 100 Q 365 100 370 120 L 370 200 Z"/>

                            <!-- C-S√§ulen -->
                            <rect class="car-part" data-part="c-saeule-l" data-category="karosserie"
                                x="50" y="40" width="25" height="65" rx="3"/>
                            <rect class="car-part" data-part="c-saeule-r" data-category="karosserie"
                                x="325" y="40" width="25" height="65" rx="3"/>

                            <!-- Dach -->
                            <path class="car-part" data-part="dach" data-category="karosserie"
                                d="M 75 40 Q 200 25 325 40 L 325 50 Q 200 35 75 50 Z"/>

                            <!-- Heckscheibe -->
                            <path class="car-part part-glas" data-part="heckscheibe" data-category="verglasung"
                                d="M 75 45 L 90 105 L 310 105 L 325 45 Q 200 30 75 45 Z"/>

                            <!-- R√ºckleuchten -->
                            <rect class="car-part" data-part="rueckleuchte-l" data-category="beleuchtung"
                                x="60" y="130" width="40" height="60" rx="5" fill="#ff6b6b" stroke="#cc0000"/>
                            <rect class="car-part" data-part="rueckleuchte-r" data-category="beleuchtung"
                                x="300" y="130" width="40" height="60" rx="5" fill="#ff6b6b" stroke="#cc0000"/>

                            <!-- 3. Bremsleuchte -->
                            <rect class="car-part" data-part="bremsleuchte-3" data-category="beleuchtung"
                                x="150" y="50" width="100" height="12" rx="3" fill="#ff6b6b" stroke="#cc0000"/>

                            <!-- Kennzeichen -->
                            <rect x="140" y="160" width="120" height="25" rx="3" fill="white" stroke="#333"/>
                        </svg>

                        <!-- DRAUFSICHT -->
                        <svg id="view-top" viewBox="0 0 250 500" class="car-svg" style="display: none;">
                            <!-- Shadow -->
                            <ellipse class="car-shadow" cx="125" cy="480" rx="80" ry="15"/>

                            <!-- Motorhaube -->
                            <path class="car-part" data-part="motorhaube" data-category="karosserie"
                                d="M 50 50 Q 125 30 200 50 L 200 130 L 50 130 Z"/>

                            <!-- Windschutzscheibe -->
                            <path class="car-part part-glas" data-part="windschutzscheibe" data-category="verglasung"
                                d="M 50 130 L 200 130 L 190 175 L 60 175 Z"/>

                            <!-- Dach -->
                            <rect class="car-part" data-part="dach" data-category="karosserie"
                                x="55" y="175" width="140" height="140" rx="8"/>

                            <!-- Schiebedach/Panoramadach -->
                            <rect class="car-part part-glas" data-part="schiebedach" data-category="verglasung"
                                x="75" y="195" width="100" height="100" rx="5"/>

                            <!-- Heckscheibe -->
                            <path class="car-part part-glas" data-part="heckscheibe" data-category="verglasung"
                                d="M 60 315 L 190 315 L 200 370 L 50 370 Z"/>

                            <!-- Heckklappe -->
                            <path class="car-part" data-part="heckklappe" data-category="karosserie"
                                d="M 50 370 L 200 370 Q 200 420 125 440 Q 50 420 50 370 Z"/>

                            <!-- Kotfl√ºgel -->
                            <path class="car-part" data-part="kotfluegel-vl" data-category="karosserie"
                                d="M 30 60 L 50 50 L 50 130 L 30 130 Q 20 100 30 60 Z"/>
                            <path class="car-part" data-part="kotfluegel-vr" data-category="karosserie"
                                d="M 220 60 L 200 50 L 200 130 L 220 130 Q 230 100 220 60 Z"/>
                            <path class="car-part" data-part="kotfluegel-hl" data-category="karosserie"
                                d="M 30 340 L 50 340 L 50 400 L 30 400 Q 20 370 30 340 Z"/>
                            <path class="car-part" data-part="kotfluegel-hr" data-category="karosserie"
                                d="M 220 340 L 200 340 L 200 400 L 220 400 Q 230 370 220 340 Z"/>

                            <!-- T√ºren -->
                            <rect class="car-part" data-part="tuer-vl" data-category="karosserie"
                                x="30" y="150" width="25" height="95" rx="3"/>
                            <rect class="car-part" data-part="tuer-vr" data-category="karosserie"
                                x="195" y="150" width="25" height="95" rx="3"/>
                            <rect class="car-part" data-part="tuer-hl" data-category="karosserie"
                                x="30" y="250" width="25" height="85" rx="3"/>
                            <rect class="car-part" data-part="tuer-hr" data-category="karosserie"
                                x="195" y="250" width="25" height="85" rx="3"/>

                            <!-- R√§der -->
                            <ellipse class="car-part" data-part="rad-vl" data-category="mechanik"
                                cx="30" cy="95" rx="15" ry="35" fill="#333" stroke="#222"/>
                            <ellipse class="car-part" data-part="rad-vr" data-category="mechanik"
                                cx="220" cy="95" rx="15" ry="35" fill="#333" stroke="#222"/>
                            <ellipse class="car-part" data-part="rad-hl" data-category="mechanik"
                                cx="30" cy="370" rx="15" ry="35" fill="#333" stroke="#222"/>
                            <ellipse class="car-part" data-part="rad-hr" data-category="mechanik"
                                cx="220" cy="370" rx="15" ry="35" fill="#333" stroke="#222"/>

                            <!-- Spiegel -->
                            <rect class="car-part" data-part="seitenspiegel-l" data-category="karosserie"
                                x="10" y="140" width="20" height="12" rx="3"/>
                            <rect class="car-part" data-part="seitenspiegel-r" data-category="karosserie"
                                x="220" y="140" width="20" height="12" rx="3"/>

                            <!-- Antenne -->
                            <circle class="car-part" data-part="antenne" data-category="karosserie"
                                cx="180" cy="300" r="5" fill="#333"/>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <!-- Selected Parts -->
                <div class="sidebar-card">
                    <h3>
                        üìã Ausgew√§hlte Teile
                        <span class="parts-count" id="partsCount">0</span>
                    </h3>
                    <ul class="selected-list" id="selectedList">
                        <li class="empty-state">
                            <div>
                                <div class="icon">üëÜ</div>
                                <div>Klicken Sie auf Teile</div>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Actions -->
                <div class="sidebar-card">
                    <h3>‚ö° Aktionen</h3>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="confirmSelection()">
                            ‚úì Auswahl best√§tigen
                        </button>
                        <button class="btn btn-danger" onclick="clearSelection()">
                            üóëÔ∏è Alle l√∂schen
                        </button>
                        <button class="btn btn-outline" onclick="exportSelection()">
                            üì§ JSON Export
                        </button>
                    </div>
                </div>

                <!-- Legend -->
                <div class="sidebar-card">
                    <h3>üé® Legende</h3>
                    <div class="legend-grid">
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--cat-karosserie)"></div>
                            <span>Karosserie</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--cat-verglasung)"></div>
                            <span>Verglasung</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--cat-beleuchtung)"></div>
                            <span>Beleuchtung</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--cat-innenraum)"></div>
                            <span>Innenraum</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--cat-mechanik)"></div>
                            <span>Mechanik</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--selected-color)"></div>
                            <span>Ausgew√§hlt</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // ============================================
        // TEILE-KATALOG
        // ============================================
        const carParts = {
            // KAROSSERIE
            'stossstange-vorne': { name: 'Sto√üstange vorne', category: 'karosserie' },
            'stossstange-hinten': { name: 'Sto√üstange hinten', category: 'karosserie' },
            'motorhaube': { name: 'Motorhaube', category: 'karosserie' },
            'heckklappe': { name: 'Heckklappe', category: 'karosserie' },
            'dach': { name: 'Dach', category: 'karosserie' },
            'kotfluegel-vl': { name: 'Kotfl√ºgel vorne links', category: 'karosserie' },
            'kotfluegel-vr': { name: 'Kotfl√ºgel vorne rechts', category: 'karosserie' },
            'kotfluegel-hl': { name: 'Kotfl√ºgel hinten links', category: 'karosserie' },
            'kotfluegel-hr': { name: 'Kotfl√ºgel hinten rechts', category: 'karosserie' },
            'tuer-vl': { name: 'T√ºr vorne links', category: 'karosserie' },
            'tuer-vr': { name: 'T√ºr vorne rechts', category: 'karosserie' },
            'tuer-hl': { name: 'T√ºr hinten links', category: 'karosserie' },
            'tuer-hr': { name: 'T√ºr hinten rechts', category: 'karosserie' },
            'schweller-l': { name: 'Schweller links', category: 'karosserie' },
            'schweller-r': { name: 'Schweller rechts', category: 'karosserie' },
            'a-saeule-l': { name: 'A-S√§ule links', category: 'karosserie' },
            'a-saeule-r': { name: 'A-S√§ule rechts', category: 'karosserie' },
            'b-saeule-l': { name: 'B-S√§ule links', category: 'karosserie' },
            'b-saeule-r': { name: 'B-S√§ule rechts', category: 'karosserie' },
            'c-saeule-l': { name: 'C-S√§ule links', category: 'karosserie' },
            'c-saeule-r': { name: 'C-S√§ule rechts', category: 'karosserie' },
            'seitenspiegel-l': { name: 'Au√üenspiegel links', category: 'karosserie' },
            'seitenspiegel-r': { name: 'Au√üenspiegel rechts', category: 'karosserie' },
            'kuehlergrill': { name: 'K√ºhlergrill', category: 'karosserie' },
            'antenne': { name: 'Dachantenne', category: 'karosserie' },

            // VERGLASUNG
            'windschutzscheibe': { name: 'Windschutzscheibe', category: 'verglasung' },
            'heckscheibe': { name: 'Heckscheibe', category: 'verglasung' },
            'scheibe-vl': { name: 'Seitenscheibe vorne links', category: 'verglasung' },
            'scheibe-vr': { name: 'Seitenscheibe vorne rechts', category: 'verglasung' },
            'scheibe-hl': { name: 'Seitenscheibe hinten links', category: 'verglasung' },
            'scheibe-hr': { name: 'Seitenscheibe hinten rechts', category: 'verglasung' },
            'schiebedach': { name: 'Panorama-/Schiebedach', category: 'verglasung' },

            // BELEUCHTUNG
            'scheinwerfer-l': { name: 'Scheinwerfer links', category: 'beleuchtung' },
            'scheinwerfer-r': { name: 'Scheinwerfer rechts', category: 'beleuchtung' },
            'nebelscheinwerfer-l': { name: 'Nebelscheinwerfer links', category: 'beleuchtung' },
            'nebelscheinwerfer-r': { name: 'Nebelscheinwerfer rechts', category: 'beleuchtung' },
            'rueckleuchte-l': { name: 'R√ºckleuchte links', category: 'beleuchtung' },
            'rueckleuchte-r': { name: 'R√ºckleuchte rechts', category: 'beleuchtung' },
            'bremsleuchte-3': { name: '3. Bremsleuchte', category: 'beleuchtung' },

            // INNENRAUM
            'sitz-fahrer': { name: 'Fahrersitz', category: 'innenraum' },
            'sitz-beifahrer': { name: 'Beifahrersitz', category: 'innenraum' },
            'lenkrad': { name: 'Lenkrad', category: 'innenraum' },

            // MECHANIK
            'rad-vl': { name: 'Rad vorne links', category: 'mechanik' },
            'rad-vr': { name: 'Rad vorne rechts', category: 'mechanik' },
            'rad-hl': { name: 'Rad hinten links', category: 'mechanik' },
            'rad-hr': { name: 'Rad hinten rechts', category: 'mechanik' },
            'auspuff': { name: 'Auspuff', category: 'mechanik' }
        };

        // ============================================
        // STATE
        // ============================================
        let selectedParts = new Set();
        let currentCategory = 'all';
        let currentView = 'side';
        let zoomLevel = 1;

        const categoryColors = {
            'karosserie': 'var(--cat-karosserie)',
            'verglasung': 'var(--cat-verglasung)',
            'beleuchtung': 'var(--cat-beleuchtung)',
            'innenraum': 'var(--cat-innenraum)',
            'mechanik': 'var(--cat-mechanik)'
        };

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            setupParts();
        });

        function initTheme() {
            const savedTheme = localStorage.getItem('teile-karte-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeUI(savedTheme);
        }

        function setupParts() {
            document.querySelectorAll('.car-part').forEach(part => {
                const partId = part.getAttribute('data-part');
                if (!partId) return;

                part.addEventListener('click', () => togglePart(partId));
                part.addEventListener('mouseenter', (e) => showTooltip(e, partId));
                part.addEventListener('mouseleave', hideTooltip);
                part.addEventListener('mousemove', moveTooltip);
            });
        }

        // ============================================
        // THEME
        // ============================================
        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            const newTheme = current === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('teile-karte-theme', newTheme);
            updateThemeUI(newTheme);
        }

        function updateThemeUI(theme) {
            document.getElementById('themeIcon').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            document.getElementById('themeText').textContent = theme === 'dark' ? 'Light' : 'Dark';
        }

        // ============================================
        // VIEW SWITCHING
        // ============================================
        function switchView(view) {
            currentView = view;

            // Update tabs
            document.querySelectorAll('.view-tab').forEach(tab => {
                tab.classList.toggle('active', tab.getAttribute('data-view') === view);
            });

            // Show/hide SVGs
            document.querySelectorAll('.car-svg').forEach(svg => {
                svg.style.display = 'none';
            });
            document.getElementById('view-' + view).style.display = 'block';

            // Re-apply selection state
            applySelectionState();

            // Apply category filter
            filterCategory(currentCategory);
        }

        function applySelectionState() {
            document.querySelectorAll('.car-part').forEach(part => {
                const partId = part.getAttribute('data-part');
                if (selectedParts.has(partId)) {
                    part.classList.add('selected');
                }
            });
        }

        // ============================================
        // ZOOM
        // ============================================
        function zoomIn() {
            zoomLevel = Math.min(zoomLevel + 0.2, 2);
            applyZoom();
        }

        function zoomOut() {
            zoomLevel = Math.max(zoomLevel - 0.2, 0.5);
            applyZoom();
        }

        function resetZoom() {
            zoomLevel = 1;
            applyZoom();
        }

        function applyZoom() {
            document.getElementById('svgContainer').style.transform = `scale(${zoomLevel})`;
        }

        // ============================================
        // CATEGORY FILTER
        // ============================================
        function filterCategory(category) {
            currentCategory = category;

            // Update buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-category') === category);
            });

            // Filter parts in current view
            const currentSvg = document.getElementById('view-' + currentView);
            currentSvg.querySelectorAll('.car-part').forEach(part => {
                const partId = part.getAttribute('data-part');
                const partInfo = carParts[partId];
                const partCategory = part.getAttribute('data-category') || partInfo?.category;

                if (category === 'all' || partCategory === category) {
                    part.classList.remove('dimmed');
                } else {
                    part.classList.add('dimmed');
                }
            });
        }

        // ============================================
        // PART SELECTION
        // ============================================
        function togglePart(partId) {
            if (selectedParts.has(partId)) {
                selectedParts.delete(partId);
                document.querySelectorAll(`[data-part="${partId}"]`).forEach(el => {
                    el.classList.remove('selected');
                });
            } else {
                selectedParts.add(partId);
                document.querySelectorAll(`[data-part="${partId}"]`).forEach(el => {
                    el.classList.add('selected');
                });
            }
            updateSelectedList();
        }

        function updateSelectedList() {
            const list = document.getElementById('selectedList');
            const count = document.getElementById('partsCount');

            count.textContent = selectedParts.size;

            if (selectedParts.size === 0) {
                list.innerHTML = `
                    <li class="empty-state">
                        <div>
                            <div class="icon">üëÜ</div>
                            <div>Klicken Sie auf Teile</div>
                        </div>
                    </li>
                `;
                return;
            }

            list.innerHTML = '';
            selectedParts.forEach(partId => {
                const partInfo = carParts[partId];
                const li = document.createElement('li');
                const catColor = categoryColors[partInfo?.category] || '#888';
                li.innerHTML = `
                    <div class="part-info">
                        <span class="category-dot" style="background: ${catColor}"></span>
                        <span>${partInfo?.name || partId}</span>
                    </div>
                    <button class="remove-btn" onclick="togglePart('${partId}')" title="Entfernen">√ó</button>
                `;
                list.appendChild(li);
            });
        }

        // ============================================
        // TOOLTIP
        // ============================================
        function showTooltip(event, partId) {
            const tooltip = document.getElementById('tooltip');
            const partInfo = carParts[partId];

            if (partInfo) {
                tooltip.innerHTML = `
                    <div class="tooltip-title">${partInfo.name}</div>
                    <div class="tooltip-category">Kategorie: ${partInfo.category.charAt(0).toUpperCase() + partInfo.category.slice(1)}</div>
                `;
            } else {
                tooltip.innerHTML = `<div class="tooltip-title">${partId}</div>`;
            }

            tooltip.classList.add('visible');
            moveTooltip(event);
        }

        function moveTooltip(event) {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.left = (event.clientX + 15) + 'px';
            tooltip.style.top = (event.clientY + 15) + 'px';
        }

        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('visible');
        }

        // ============================================
        // ACTIONS
        // ============================================
        function clearSelection() {
            selectedParts.clear();
            document.querySelectorAll('.car-part.selected').forEach(el => {
                el.classList.remove('selected');
            });
            updateSelectedList();
        }

        function confirmSelection() {
            if (selectedParts.size === 0) {
                alert('Bitte w√§hlen Sie mindestens ein Teil aus.');
                return;
            }

            const parts = Array.from(selectedParts).map(id => ({
                id,
                name: carParts[id]?.name || id,
                category: carParts[id]?.category || 'unknown'
            }));

            const byCategory = {};
            parts.forEach(p => {
                if (!byCategory[p.category]) byCategory[p.category] = [];
                byCategory[p.category].push(p.name);
            });

            let message = `‚úÖ ${parts.length} Teil(e) ausgew√§hlt:\n\n`;
            Object.entries(byCategory).forEach(([cat, names]) => {
                message += `üìÅ ${cat.toUpperCase()}:\n`;
                names.forEach(n => message += `   ‚Ä¢ ${n}\n`);
                message += '\n';
            });

            alert(message);
            console.log('Ausgew√§hlte Teile:', parts);
        }

        function exportSelection() {
            const data = {
                timestamp: new Date().toISOString(),
                partsCount: selectedParts.size,
                parts: Array.from(selectedParts).map(id => ({
                    id,
                    name: carParts[id]?.name || id,
                    category: carParts[id]?.category || 'unknown'
                }))
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fahrzeugteile-auswahl-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
